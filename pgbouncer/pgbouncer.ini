[databases]
; Database-name  = host=hostname port=port dbname=database
spywatcher = host=postgres port=5432 dbname=spywatcher

[pgbouncer]
; Connection pooling mode (session, transaction, or statement)
; session - one server connection per client connection (default)
; transaction - one server connection per transaction
; statement - one server connection per statement (not recommended for prepared statements)
pool_mode = transaction

; Listen address and port
listen_addr = 0.0.0.0
listen_port = 6432

; Authentication
auth_type = md5
auth_file = /etc/pgbouncer/userlist.txt

; Administrator credentials
admin_users = pgbouncer_admin

; Connection limits per pool
; Total for all pools = default_pool_size * num_databases
default_pool_size = 25
min_pool_size = 5
reserve_pool_size = 5
reserve_pool_timeout = 3

; Maximum allowed connections per database per user
max_db_connections = 50
max_user_connections = 50

; Maximum total client connections
max_client_conn = 100

; Server connection lifetime
server_lifetime = 3600
server_idle_timeout = 600

; Client connection limits
server_connect_timeout = 15
server_login_retry = 15

; Query timeouts
query_timeout = 0
query_wait_timeout = 120
client_idle_timeout = 0
idle_transaction_timeout = 0

; Logging
log_connections = 1
log_disconnections = 1
log_pooler_errors = 1
stats_period = 60

; This prevents errors when server connection is lost
server_reset_query = DISCARD ALL
server_reset_query_always = 0

; Ignore startup parameters
ignore_startup_parameters = extra_float_digits

; Application name
application_name_add_host = 1

; DNS settings
dns_max_ttl = 15
dns_nxdomain_ttl = 15
dns_zone_check_period = 0

; TLS/SSL settings (disabled by default for internal network)
;client_tls_sslmode = disable
;server_tls_sslmode = disable

; Performance tuning
pkt_buf = 4096
listen_backlog = 128
sbuf_loopcnt = 5
suspend_timeout = 10
tcp_keepalive = 1
tcp_keepidle = 0
tcp_keepintvl = 0
tcp_keepcnt = 0
tcp_user_timeout = 0
